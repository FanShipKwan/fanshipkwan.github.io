<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>PANDAS常用手册 VI --数据转换 | 因缺斯汀</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="PYTHON科学计算" />
    
    <meta name="description" content="转载自实验楼作者 木木同学 的课程[《PYTHON数据分析》][1]

一、实验介绍　到目前为止，之前介绍的都是数据的重排。而另一类重要操作则是过滤、清理以及其他的转换工作。今天我们就来更深入的学习数据的转换知识吧！">
<meta property="og:type" content="article">
<meta property="og:title" content="PANDAS常用手册 VI --数据转换">
<meta property="og:url" content="http://yoursite.com/2016/05/24/PANDAS常用手册-VI-数据转换/index.html">
<meta property="og:site_name" content="因缺斯汀">
<meta property="og:description" content="转载自实验楼作者 木木同学 的课程[《PYTHON数据分析》][1]

一、实验介绍　到目前为止，之前介绍的都是数据的重排。而另一类重要操作则是过滤、清理以及其他的转换工作。今天我们就来更深入的学习数据的转换知识吧！">
<meta property="og:updated_time" content="2016-05-24T13:29:20.358Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PANDAS常用手册 VI --数据转换">
<meta name="twitter:description" content="转载自实验楼作者 木木同学 的课程[《PYTHON数据分析》][1]

一、实验介绍　到目前为止，之前介绍的都是数据的重排。而另一类重要操作则是过滤、清理以及其他的转换工作。今天我们就来更深入的学习数据的转换知识吧！">
    

    

    

    <link rel="stylesheet" href="/vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/vendor/titillium-web/styles.css">
    <link rel="stylesheet" href="/vendor/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/vendor/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/vendor/fancybox/jquery.fancybox.css">
    
    
        <link rel="stylesheet" href="/vendor/scrollLoading/style.css">
    
    
    

</head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">Interesting</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">index.首页</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/studay">index.学习</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/game">index.游戏</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    uncategorized
    </h1>
</div>
                        <div class="main-body-content">
                            <article id="post-PANDAS常用手册-VI-数据转换" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        PANDAS常用手册 VI --数据转换
        </h1>
    

            </header>
        
        <div class="article-subtitle">
            <a href="/2016/05/24/PANDAS常用手册-VI-数据转换/" class="article-date">
    <time datetime="2016-05-24T13:23:57.382Z" itemprop="datePublished">2016-05-24</time>
</a>
            
    <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PYTHON科学计算/">PYTHON科学计算</a></li></ul>

        </div>
        <div class="article-entry" itemprop="articleBody">
            <blockquote>
<p>转载自实验楼作者 <strong>木木同学</strong> 的课程[《PYTHON数据分析》][1]</p>
</blockquote>
<h2 id="一、实验介绍"><a href="#一、实验介绍" class="headerlink" title="一、实验介绍"></a><strong>一、实验介绍</strong></h2><p>　到目前为止，之前介绍的都是数据的重排。而另一类重要操作则是过滤、清理以及其他的转换工作。今天我们就来更深入的学习数据的转换知识吧！<br><a id="more"></a></p>
<h2 id="二、移除重复数据"><a href="#二、移除重复数据" class="headerlink" title="二、移除重复数据"></a><strong>二、移除重复数据</strong></h2><p>　　DataFrame 中常常会出现重复行，举个例子：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">5</span>]: data = DataFrame(&#123;<span class="string">'k1'</span>:[<span class="string">'one'</span>]*<span class="number">3</span>+[<span class="string">'two'</span>]*<span class="number">4</span>,</span><br><span class="line">                  <span class="string">'k2'</span>:[<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">4</span>]&#125;)</span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: data</span><br><span class="line">Out[<span class="number">6</span>]: </span><br><span class="line">    k1  k2</span><br><span class="line"><span class="number">0</span>  one   <span class="number">1</span></span><br><span class="line"><span class="number">1</span>  one   <span class="number">1</span></span><br><span class="line"><span class="number">2</span>  one   <span class="number">2</span></span><br><span class="line"><span class="number">3</span>  two   <span class="number">3</span></span><br><span class="line"><span class="number">4</span>  two   <span class="number">3</span></span><br><span class="line"><span class="number">5</span>  two   <span class="number">4</span></span><br><span class="line"><span class="number">6</span>  two   <span class="number">4</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]: <span class="comment">#DataFrame 的 duplicated 方法返回一个布尔型 Seriess</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">8</span>]: <span class="comment"># 表示各行是否是重复行</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">9</span>]:  data.duplicated()</span><br><span class="line">Out[<span class="number">9</span>]: </span><br><span class="line"><span class="number">0</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">1</span>     <span class="keyword">True</span></span><br><span class="line"><span class="number">2</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">3</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">4</span>     <span class="keyword">True</span></span><br><span class="line"><span class="number">5</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">6</span>     <span class="keyword">True</span></span><br><span class="line">dtype: bool</span><br><span class="line"></span><br><span class="line">In [<span class="number">10</span>]: <span class="comment">#drop_duplicates 方法，用于返回一个移除了重复行的 DataFrame</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">11</span>]: data.drop_duplicates()</span><br><span class="line">Out[<span class="number">11</span>]: </span><br><span class="line">    k1  k2</span><br><span class="line"><span class="number">0</span>  one   <span class="number">1</span></span><br><span class="line"><span class="number">2</span>  one   <span class="number">2</span></span><br><span class="line"><span class="number">3</span>  two   <span class="number">3</span></span><br><span class="line"><span class="number">5</span>  two   <span class="number">4</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">12</span>]: <span class="comment"># 这个方法默认会判断全部列</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">13</span>]: <span class="comment">#当然我们也可以指定部分列进行重复判断</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">14</span>]: data[<span class="string">'v1'</span>] = range(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">15</span>]: data</span><br><span class="line">Out[<span class="number">15</span>]: </span><br><span class="line">    k1  k2  v1</span><br><span class="line"><span class="number">0</span>  one   <span class="number">1</span>   <span class="number">0</span></span><br><span class="line"><span class="number">1</span>  one   <span class="number">1</span>   <span class="number">1</span></span><br><span class="line"><span class="number">2</span>  one   <span class="number">2</span>   <span class="number">2</span></span><br><span class="line"><span class="number">3</span>  two   <span class="number">3</span>   <span class="number">3</span></span><br><span class="line"><span class="number">4</span>  two   <span class="number">3</span>   <span class="number">4</span></span><br><span class="line"><span class="number">5</span>  two   <span class="number">4</span>   <span class="number">5</span></span><br><span class="line"><span class="number">6</span>  two   <span class="number">4</span>   <span class="number">6</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">16</span>]: data.drop_duplicates([<span class="string">'k1'</span>])</span><br><span class="line">Out[<span class="number">16</span>]: </span><br><span class="line">    k1  k2  v1</span><br><span class="line"><span class="number">0</span>  one   <span class="number">1</span>   <span class="number">0</span></span><br><span class="line"><span class="number">3</span>  two   <span class="number">3</span>   <span class="number">3</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">17</span>]: <span class="comment"># 上面是只通过k1列过滤重复项</span></span><br><span class="line">　　duplicated 和 drop_duplicates 默认保留的是第一个出现的值组合。传入 take_last = <span class="keyword">True</span> 则保留最后一个：</span><br><span class="line"></span><br><span class="line">In [<span class="number">18</span>]: data.drop_duplicates([<span class="string">'k1'</span>,<span class="string">'k2'</span>],take_last = <span class="keyword">True</span>)</span><br><span class="line">Out[<span class="number">18</span>]: </span><br><span class="line">    k1  k2  v1</span><br><span class="line"><span class="number">1</span>  one   <span class="number">1</span>   <span class="number">1</span></span><br><span class="line"><span class="number">2</span>  one   <span class="number">2</span>   <span class="number">2</span></span><br><span class="line"><span class="number">4</span>  two   <span class="number">3</span>   <span class="number">4</span></span><br><span class="line"><span class="number">6</span>  two   <span class="number">4</span>   <span class="number">6</span></span><br></pre></td></tr></table></figure></p>
<h2 id="三、利用函数或映射进行数据转换"><a href="#三、利用函数或映射进行数据转换" class="headerlink" title="三、利用函数或映射进行数据转换"></a><strong>三、利用函数或映射进行数据转换</strong></h2><p>　　在对数据集进行转换时，我们希望根据数组、<code>Series</code> 或 <code>DataFrame</code> 列中的值来实现工作。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">4</span>]: data = DataFrame(&#123;<span class="string">'food'</span>:[<span class="string">'bacon'</span>,<span class="string">'pulled pork'</span>,<span class="string">'bacon'</span>,</span><br><span class="line">   ...:                           <span class="string">'pastrami'</span>,<span class="string">'corned beef'</span>,<span class="string">'bacon'</span>,</span><br><span class="line">   ...:                           <span class="string">'pastrami'</span>,<span class="string">'honey ham'</span>,<span class="string">'nova lox'</span>],</span><br><span class="line">   ...:                   <span class="string">'ounces'</span>:[<span class="number">4</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">7.5</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>]&#125;)</span><br><span class="line"></span><br><span class="line">In [<span class="number">5</span>]: data</span><br><span class="line">Out[<span class="number">5</span>]: </span><br><span class="line">          food  ounces</span><br><span class="line"><span class="number">0</span>        bacon     <span class="number">4.0</span></span><br><span class="line"><span class="number">1</span>  pulled pork     <span class="number">3.0</span></span><br><span class="line"><span class="number">2</span>        bacon    <span class="number">12.0</span></span><br><span class="line"><span class="number">3</span>     pastrami     <span class="number">6.0</span></span><br><span class="line"><span class="number">4</span>  corned beef     <span class="number">7.5</span></span><br><span class="line"><span class="number">5</span>        bacon     <span class="number">8.0</span></span><br><span class="line"><span class="number">6</span>     pastrami     <span class="number">3.0</span></span><br><span class="line"><span class="number">7</span>    honey ham     <span class="number">5.0</span></span><br><span class="line"><span class="number">8</span>     nova lox     <span class="number">6.0</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: <span class="comment"># 我们添加一个食物来源</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]:  meat_to_animal = &#123;</span><br><span class="line">   ...: <span class="string">'bacon'</span>: <span class="string">'pig'</span>,</span><br><span class="line">   ...: <span class="string">'pulled pork'</span>: <span class="string">'pig'</span>,</span><br><span class="line">   ...: <span class="string">'pastrami'</span>: <span class="string">'cow'</span>,</span><br><span class="line">   ...: <span class="string">'corned beef'</span>: <span class="string">'cow'</span>,</span><br><span class="line">   ...: <span class="string">'honey ham'</span>: <span class="string">'pig'</span>,</span><br><span class="line">   ...: <span class="string">'nova lox'</span>: <span class="string">'salmon'</span></span><br><span class="line">   ...: &#125;</span><br><span class="line"></span><br><span class="line">In [<span class="number">8</span>]: <span class="comment">#Series 的 map 方法可以接受一个函数或含有映射关系的字典型对象</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">9</span>]: data[<span class="string">'animal'</span>] = data[<span class="string">'food'</span>].map(meat_to_animal)</span><br><span class="line"></span><br><span class="line">In [<span class="number">10</span>]: data</span><br><span class="line">Out[<span class="number">10</span>]: </span><br><span class="line">          food  ounces  animal</span><br><span class="line"><span class="number">0</span>        bacon     <span class="number">4.0</span>     pig</span><br><span class="line"><span class="number">1</span>  pulled pork     <span class="number">3.0</span>     pig</span><br><span class="line"><span class="number">2</span>        bacon    <span class="number">12.0</span>     pig</span><br><span class="line"><span class="number">3</span>     pastrami     <span class="number">6.0</span>     cow</span><br><span class="line"><span class="number">4</span>  corned beef     <span class="number">7.5</span>     cow</span><br><span class="line"><span class="number">5</span>        bacon     <span class="number">8.0</span>     pig</span><br><span class="line"><span class="number">6</span>     pastrami     <span class="number">3.0</span>     cow</span><br><span class="line"><span class="number">7</span>    honey ham     <span class="number">5.0</span>     pig</span><br><span class="line"><span class="number">8</span>     nova lox     <span class="number">6.0</span>  salmon</span><br><span class="line"></span><br><span class="line">In [<span class="number">11</span>]: <span class="comment"># 我们也可以传入一个能够完成全部工作的函数：</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In [<span class="number">12</span>]: data[<span class="string">'food'</span>].map(<span class="keyword">lambda</span> x: meat_to_animal[x])</span><br><span class="line">Out[<span class="number">12</span>]: </span><br><span class="line"><span class="number">0</span>       pig</span><br><span class="line"><span class="number">1</span>       pig</span><br><span class="line"><span class="number">2</span>       pig</span><br><span class="line"><span class="number">3</span>       cow</span><br><span class="line"><span class="number">4</span>       cow</span><br><span class="line"><span class="number">5</span>       pig</span><br><span class="line"><span class="number">6</span>       cow</span><br><span class="line"><span class="number">7</span>       pig</span><br><span class="line"><span class="number">8</span>    salmon</span><br><span class="line">Name: food, dtype: object</span><br><span class="line">　　使用 map 是一种实现元素级转换以及其他数据清理工作的便捷方式。</span><br></pre></td></tr></table></figure></p>
<h2 id="四、替换值"><a href="#四、替换值" class="headerlink" title="四、替换值"></a><strong>四、替换值</strong></h2><p>　　利用 fillna 方法填充缺失数据可以看做值替换的一种特殊情况。虽然前面提到的 map 可用于修改对象的数据子集，而 replace 则提供了一种实现该功能的更简单、更灵活的方式<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">20</span>]: data = Series([<span class="number">1.</span>, <span class="number">-999.</span>, <span class="number">2.</span>, <span class="number">-999.</span>, <span class="number">-1000.</span>, <span class="number">3.</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">21</span>]: data</span><br><span class="line">Out[<span class="number">21</span>]: </span><br><span class="line"><span class="number">0</span>       <span class="number">1</span></span><br><span class="line"><span class="number">1</span>    <span class="number">-999</span></span><br><span class="line"><span class="number">2</span>       <span class="number">2</span></span><br><span class="line"><span class="number">3</span>    <span class="number">-999</span></span><br><span class="line"><span class="number">4</span>   <span class="number">-1000</span></span><br><span class="line"><span class="number">5</span>       <span class="number">3</span></span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line">In [<span class="number">22</span>]: <span class="comment">#接下来我想将-999 换成 NAN</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">23</span>]: data.replace(<span class="number">-999</span>, np.nan)</span><br><span class="line">Out[<span class="number">23</span>]: </span><br><span class="line"><span class="number">0</span>       <span class="number">1</span></span><br><span class="line"><span class="number">1</span>     NaN</span><br><span class="line"><span class="number">2</span>       <span class="number">2</span></span><br><span class="line"><span class="number">3</span>     NaN</span><br><span class="line"><span class="number">4</span>   <span class="number">-1000</span></span><br><span class="line"><span class="number">5</span>       <span class="number">3</span></span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line">In [<span class="number">24</span>]: <span class="comment"># 如果我们想一次性换多个值</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">25</span>]:  data.replace([<span class="number">-999</span>,<span class="number">-1000</span>],np.nan)</span><br><span class="line">Out[<span class="number">25</span>]: </span><br><span class="line"><span class="number">0</span>     <span class="number">1</span></span><br><span class="line"><span class="number">1</span>   NaN</span><br><span class="line"><span class="number">2</span>     <span class="number">2</span></span><br><span class="line"><span class="number">3</span>   NaN</span><br><span class="line"><span class="number">4</span>   NaN</span><br><span class="line"><span class="number">5</span>     <span class="number">3</span></span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line">In [<span class="number">26</span>]: data.replace([<span class="number">-999</span>,<span class="number">-1000</span>],[np.nan, <span class="number">0</span>])</span><br><span class="line">Out[<span class="number">26</span>]: </span><br><span class="line"><span class="number">0</span>     <span class="number">1</span></span><br><span class="line"><span class="number">1</span>   NaN</span><br><span class="line"><span class="number">2</span>     <span class="number">2</span></span><br><span class="line"><span class="number">3</span>   NaN</span><br><span class="line"><span class="number">4</span>     <span class="number">0</span></span><br><span class="line"><span class="number">5</span>     <span class="number">3</span></span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line">In [<span class="number">27</span>]: data.replace(&#123;<span class="number">-999</span>: np.nan, <span class="number">-1000</span>: <span class="number">0</span>&#125;)</span><br><span class="line">Out[<span class="number">27</span>]: </span><br><span class="line"><span class="number">0</span>     <span class="number">1</span></span><br><span class="line"><span class="number">1</span>   NaN</span><br><span class="line"><span class="number">2</span>     <span class="number">2</span></span><br><span class="line"><span class="number">3</span>   NaN</span><br><span class="line"><span class="number">4</span>     <span class="number">0</span></span><br><span class="line"><span class="number">5</span>     <span class="number">3</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure></p>
<h2 id="五、重命名轴索引"><a href="#五、重命名轴索引" class="headerlink" title="五、重命名轴索引"></a><strong>五、重命名轴索引</strong></h2><p>　　跟 Series 中的值一样，轴标签也可以通过函数或映射进行转换，从而得到一个新对象。轴还可以被就地修改，而无需新建一个数据结构。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">28</span>]: data = DataFrame(np.arange(<span class="number">12</span>).reshape((<span class="number">3</span>,<span class="number">4</span>)),</span><br><span class="line">   ....:                  index = [<span class="string">'Ohio'</span>,<span class="string">'Colorado'</span>,<span class="string">'New York'</span>],</span><br><span class="line">   ....:                  columns = [<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>,<span class="string">'four'</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">29</span>]: <span class="comment"># 跟 Series 一样，轴标签也有一个 map 方法</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">30</span>]: data.index.map(str.upper)</span><br><span class="line">Out[<span class="number">30</span>]: array([<span class="string">'OHIO'</span>, <span class="string">'COLORADO'</span>, <span class="string">'NEW YORK'</span>], dtype=object)</span><br><span class="line"></span><br><span class="line">In [<span class="number">31</span>]: <span class="comment"># 同样我们也可以赋值给 index</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">32</span>]: data.index = data.index.map(str.upper)</span><br><span class="line"></span><br><span class="line">In [<span class="number">33</span>]: data</span><br><span class="line">Out[<span class="number">33</span>]: </span><br><span class="line">          one  two  three  four</span><br><span class="line">OHIO        <span class="number">0</span>    <span class="number">1</span>      <span class="number">2</span>     <span class="number">3</span></span><br><span class="line">COLORADO    <span class="number">4</span>    <span class="number">5</span>      <span class="number">6</span>     <span class="number">7</span></span><br><span class="line">NEW YORK    <span class="number">8</span>    <span class="number">9</span>     <span class="number">10</span>    <span class="number">11</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">34</span>]: <span class="comment"># 如果想要创建数据集的转换版（不是修改原始数据）</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">35</span>]: data.rename(index = str.title,columns = str.upper)</span><br><span class="line">Out[<span class="number">35</span>]: </span><br><span class="line">          ONE  TWO  THREE  FOUR</span><br><span class="line">Ohio        <span class="number">0</span>    <span class="number">1</span>      <span class="number">2</span>     <span class="number">3</span></span><br><span class="line">Colorado    <span class="number">4</span>    <span class="number">5</span>      <span class="number">6</span>     <span class="number">7</span></span><br><span class="line">New York    <span class="number">8</span>    <span class="number">9</span>     <span class="number">10</span>    <span class="number">11</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">36</span>]: <span class="comment">#rename 可以结合字典对象实现部分轴标签的更新</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">37</span>]: data.rename(index=&#123;<span class="string">'OHIO'</span>:<span class="string">'INDIANA'</span>&#125;,</span><br><span class="line">   ....:             columns = &#123;<span class="string">'three'</span>:<span class="string">'peekaboo'</span>&#125;)</span><br><span class="line">Out[<span class="number">37</span>]: </span><br><span class="line">          one  two  peekaboo  four</span><br><span class="line">INDIANA     <span class="number">0</span>    <span class="number">1</span>         <span class="number">2</span>     <span class="number">3</span></span><br><span class="line">COLORADO    <span class="number">4</span>    <span class="number">5</span>         <span class="number">6</span>     <span class="number">7</span></span><br><span class="line">NEW YORK    <span class="number">8</span>    <span class="number">9</span>        <span class="number">10</span>    <span class="number">11</span></span><br></pre></td></tr></table></figure></p>
<h2 id="六、离散化和面元划分"><a href="#六、离散化和面元划分" class="headerlink" title="六、离散化和面元划分"></a><strong>六、离散化和面元划分</strong></h2><p>　　为了便于分析，连续数据常常被离散化或拆分为“面元”（bin）。假设有一组人员数据，我们希望将它们划分为不同的年龄组：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">39</span>]: ages = [<span class="number">20</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">37</span>, <span class="number">31</span>,<span class="number">61</span>, <span class="number">42</span>, <span class="number">48</span>, <span class="number">32</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">40</span>]: <span class="comment"># 接下来我们将这些数据分成18~25、26~35、35~60和60岁以上</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">41</span>]:  bins = [<span class="number">18</span>, <span class="number">25</span>, <span class="number">35</span>, <span class="number">60</span>, <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">42</span>]: cats = pd.cut(ages,bins)</span><br><span class="line"></span><br><span class="line">In [<span class="number">43</span>]: cats</span><br><span class="line">Out[<span class="number">43</span>]: </span><br><span class="line">[(<span class="number">18</span>, <span class="number">25</span>], (<span class="number">18</span>, <span class="number">25</span>], (<span class="number">18</span>, <span class="number">25</span>], (<span class="number">25</span>, <span class="number">35</span>], (<span class="number">18</span>, <span class="number">25</span>], ..., (<span class="number">25</span>, <span class="number">35</span>], (<span class="number">60</span>, <span class="number">100</span>], (<span class="number">35</span>, <span class="number">60</span>], (<span class="number">35</span>, <span class="number">60</span>], (<span class="number">25</span>, <span class="number">35</span>]]</span><br><span class="line">Length: <span class="number">14</span></span><br><span class="line">Categories (<span class="number">4</span>, object): [(<span class="number">18</span>, <span class="number">25</span>] &lt; (<span class="number">25</span>, <span class="number">35</span>] &lt; (<span class="number">35</span>, <span class="number">60</span>] &lt; (<span class="number">60</span>, <span class="number">100</span>]]</span><br><span class="line"></span><br><span class="line">In [<span class="number">44</span>]: <span class="comment">#pandas  用 cut 函数返回的是一个特殊的 Categorical 对象</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">45</span>]: <span class="comment">#我们可以将其看做一组表示面元名称的字符串</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">46</span>]: <span class="comment">#它含有一个表示不同分类名称的 levels 数组</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">47</span>]: cats.levels</span><br><span class="line">Out[<span class="number">47</span>]: Index([<span class="string">u'(18, 25]'</span>, <span class="string">u'(25, 35]'</span>, <span class="string">u'(35, 60]'</span>, <span class="string">u'(60, 100]'</span>], dtype=<span class="string">'object'</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">48</span>]: <span class="comment"># 还有一个为年龄数据进行标号的 labels 属性</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">49</span>]:  cats.labels</span><br><span class="line">Out[<span class="number">49</span>]: array([ <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">0</span>,  <span class="number">0</span>,  <span class="number">0</span>, <span class="number">-1</span>,  <span class="number">2</span>,  <span class="number">1</span>,  <span class="number">3</span>,  <span class="number">2</span>,  <span class="number">2</span>,  <span class="number">1</span>], dtype=int8)</span><br><span class="line"></span><br><span class="line">In [<span class="number">50</span>]: pd.value_counts(cats)</span><br><span class="line">Out[<span class="number">50</span>]: </span><br><span class="line">(<span class="number">18</span>, <span class="number">25</span>]     <span class="number">6</span></span><br><span class="line">(<span class="number">35</span>, <span class="number">60</span>]     <span class="number">3</span></span><br><span class="line">(<span class="number">25</span>, <span class="number">35</span>]     <span class="number">3</span></span><br><span class="line">(<span class="number">60</span>, <span class="number">100</span>]    <span class="number">1</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>　　<br>　　如果向 cut 传入的是面元的数量而不是确切的面元边界，则它会根据数据的最小值和最大值计算等长面元。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">56</span>]: data = np.random.rand(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">57</span>]: pd.cut(data, <span class="number">4</span>, precision = <span class="number">2</span>)</span><br><span class="line">Out[<span class="number">57</span>]: </span><br><span class="line">[(<span class="number">0.72</span>, <span class="number">0.96</span>], (<span class="number">0.25</span>, <span class="number">0.49</span>], (<span class="number">0.49</span>, <span class="number">0.72</span>], (<span class="number">0.72</span>, <span class="number">0.96</span>], (<span class="number">0.25</span>, <span class="number">0.49</span>], ..., (<span class="number">0.014</span>, <span class="number">0.25</span>], (<span class="number">0.72</span>, <span class="number">0.96</span>], (<span class="number">0.49</span>, <span class="number">0.72</span>], (<span class="number">0.25</span>, <span class="number">0.49</span>], (<span class="number">0.72</span>, <span class="number">0.96</span>]]</span><br><span class="line">Length: <span class="number">20</span></span><br><span class="line">Categories (<span class="number">4</span>, object): [(<span class="number">0.014</span>, <span class="number">0.25</span>] &lt; (<span class="number">0.25</span>, <span class="number">0.49</span>] &lt; (<span class="number">0.49</span>, <span class="number">0.72</span>] &lt; (<span class="number">0.72</span>, <span class="number">0.96</span>]]</span><br></pre></td></tr></table></figure>
<p>　　<code>qcut</code> 是一个非常类似于<code>cut</code>的函数，它可以根据样本分位数对数据进行面元划分。根据数据的分布情况，<code>cut</code>可能无法使各个面元含有相同数量的数据点。而<code>qcut</code>由于使用的是样本分位数，因此可以得到大小基本相等的面元：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">58</span>]: data = np.random.randn(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">59</span>]: cats = pd.qcut(data,<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">60</span>]: cats</span><br><span class="line">Out[<span class="number">60</span>]: </span><br><span class="line">[(<span class="number">-0.699</span>, <span class="number">0.0415</span>], [<span class="number">-3.0467</span>, <span class="number">-0.699</span>], (<span class="number">0.0415</span>, <span class="number">0.731</span>], (<span class="number">0.731</span>, <span class="number">3.0755</span>], [<span class="number">-3.0467</span>, <span class="number">-0.699</span>], ..., (<span class="number">0.0415</span>, <span class="number">0.731</span>], [<span class="number">-3.0467</span>, <span class="number">-0.699</span>], (<span class="number">-0.699</span>, <span class="number">0.0415</span>], [<span class="number">-3.0467</span>, <span class="number">-0.699</span>], [<span class="number">-3.0467</span>, <span class="number">-0.699</span>]]</span><br><span class="line">Length: <span class="number">1000</span></span><br><span class="line">Categories (<span class="number">4</span>, object): [[<span class="number">-3.0467</span>, <span class="number">-0.699</span>] &lt; (<span class="number">-0.699</span>, <span class="number">0.0415</span>] &lt; (<span class="number">0.0415</span>, <span class="number">0.731</span>] &lt; (<span class="number">0.731</span>, <span class="number">3.0755</span>]]</span><br><span class="line"></span><br><span class="line">In [<span class="number">61</span>]: pd.value_counts(cats)</span><br><span class="line">Out[<span class="number">61</span>]: </span><br><span class="line">(<span class="number">0.731</span>, <span class="number">3.0755</span>]      <span class="number">250</span></span><br><span class="line">(<span class="number">0.0415</span>, <span class="number">0.731</span>]      <span class="number">250</span></span><br><span class="line">(<span class="number">-0.699</span>, <span class="number">0.0415</span>]     <span class="number">250</span></span><br><span class="line">[<span class="number">-3.0467</span>, <span class="number">-0.699</span>]    <span class="number">250</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure></p>
<h2 id="七、检测和过滤异常值"><a href="#七、检测和过滤异常值" class="headerlink" title="七、检测和过滤异常值"></a><strong>七、检测和过滤异常值</strong></h2><p>　　异常值（outlier）的过滤或变换运算在很大程度上其实就是数组运算。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">63</span>]: np.random.seed(<span class="number">12345</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">64</span>]: data = DataFrame(np.random.randn(<span class="number">1000</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">In [<span class="number">65</span>]: data.describe()</span><br><span class="line">Out[<span class="number">65</span>]: </span><br><span class="line">                 <span class="number">0</span>            <span class="number">1</span>            <span class="number">2</span>            <span class="number">3</span></span><br><span class="line">count  <span class="number">1000.000000</span>  <span class="number">1000.000000</span>  <span class="number">1000.000000</span>  <span class="number">1000.000000</span></span><br><span class="line">mean     <span class="number">-0.067684</span>     <span class="number">0.067924</span>     <span class="number">0.025598</span>    <span class="number">-0.002298</span></span><br><span class="line">std       <span class="number">0.998035</span>     <span class="number">0.992106</span>     <span class="number">1.006835</span>     <span class="number">0.996794</span></span><br><span class="line">min      <span class="number">-3.428254</span>    <span class="number">-3.548824</span>    <span class="number">-3.184377</span>    <span class="number">-3.745356</span></span><br><span class="line"><span class="number">25</span>%      <span class="number">-0.774890</span>    <span class="number">-0.591841</span>    <span class="number">-0.641675</span>    <span class="number">-0.644144</span></span><br><span class="line"><span class="number">50</span>%      <span class="number">-0.116401</span>     <span class="number">0.101143</span>     <span class="number">0.002073</span>    <span class="number">-0.013611</span></span><br><span class="line"><span class="number">75</span>%       <span class="number">0.616366</span>     <span class="number">0.780282</span>     <span class="number">0.680391</span>     <span class="number">0.654328</span></span><br><span class="line">max       <span class="number">3.366626</span>     <span class="number">2.653656</span>     <span class="number">3.260383</span>     <span class="number">3.927528</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">66</span>]: <span class="comment"># 假设你想要找出某列中绝对值大小超过3的值</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">67</span>]:  col = data[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">68</span>]: col[np.abs(col) &gt; <span class="number">3</span>]</span><br><span class="line">Out[<span class="number">68</span>]: </span><br><span class="line"><span class="number">97</span>     <span class="number">3.927528</span></span><br><span class="line"><span class="number">305</span>   <span class="number">-3.399312</span></span><br><span class="line"><span class="number">400</span>   <span class="number">-3.745356</span></span><br><span class="line">Name: <span class="number">3</span>, dtype: float64</span><br><span class="line"></span><br><span class="line">In [<span class="number">69</span>]: <span class="comment"># 要选出全部的绝对值大于三的行</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">70</span>]: data[(np.abs(data)&gt;<span class="number">3</span>).any(<span class="number">1</span>)]</span><br><span class="line">Out[<span class="number">70</span>]: </span><br><span class="line">            <span class="number">0</span>         <span class="number">1</span>         <span class="number">2</span>         <span class="number">3</span></span><br><span class="line"><span class="number">5</span>   <span class="number">-0.539741</span>  <span class="number">0.476985</span>  <span class="number">3.248944</span> <span class="number">-1.021228</span></span><br><span class="line"><span class="number">97</span>  <span class="number">-0.774363</span>  <span class="number">0.552936</span>  <span class="number">0.106061</span>  <span class="number">3.927528</span></span><br><span class="line"><span class="number">102</span> <span class="number">-0.655054</span> <span class="number">-0.565230</span>  <span class="number">3.176873</span>  <span class="number">0.959533</span></span><br><span class="line"><span class="number">305</span> <span class="number">-2.315555</span>  <span class="number">0.457246</span> <span class="number">-0.025907</span> <span class="number">-3.399312</span></span><br><span class="line"><span class="number">324</span>  <span class="number">0.050188</span>  <span class="number">1.951312</span>  <span class="number">3.260383</span>  <span class="number">0.963301</span></span><br><span class="line"><span class="number">400</span>  <span class="number">0.146326</span>  <span class="number">0.508391</span> <span class="number">-0.196713</span> <span class="number">-3.745356</span></span><br><span class="line"><span class="number">499</span> <span class="number">-0.293333</span> <span class="number">-0.242459</span> <span class="number">-3.056990</span>  <span class="number">1.918403</span></span><br><span class="line"><span class="number">523</span> <span class="number">-3.428254</span> <span class="number">-0.296336</span> <span class="number">-0.439938</span> <span class="number">-0.867165</span></span><br><span class="line"><span class="number">586</span>  <span class="number">0.275144</span>  <span class="number">1.179227</span> <span class="number">-3.184377</span>  <span class="number">1.369891</span></span><br><span class="line"><span class="number">808</span> <span class="number">-0.362528</span> <span class="number">-3.548824</span>  <span class="number">1.553205</span> <span class="number">-2.186301</span></span><br><span class="line"><span class="number">900</span>  <span class="number">3.366626</span> <span class="number">-2.372214</span>  <span class="number">0.851010</span>  <span class="number">1.332846</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">71</span>]: <span class="comment">#根据这些条件，既可以轻松对值进行设置</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">72</span>]:  data[np.abs(data)&gt;<span class="number">3</span>] = np.sign(data)*<span class="number">3</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">73</span>]: data.describe()</span><br><span class="line">Out[<span class="number">73</span>]: </span><br><span class="line">                 <span class="number">0</span>            <span class="number">1</span>            <span class="number">2</span>            <span class="number">3</span></span><br><span class="line">count  <span class="number">1000.000000</span>  <span class="number">1000.000000</span>  <span class="number">1000.000000</span>  <span class="number">1000.000000</span></span><br><span class="line">mean     <span class="number">-0.067623</span>     <span class="number">0.068473</span>     <span class="number">0.025153</span>    <span class="number">-0.002081</span></span><br><span class="line">std       <span class="number">0.995485</span>     <span class="number">0.990253</span>     <span class="number">1.003977</span>     <span class="number">0.989736</span></span><br><span class="line">min      <span class="number">-3.000000</span>    <span class="number">-3.000000</span>    <span class="number">-3.000000</span>    <span class="number">-3.000000</span></span><br><span class="line"><span class="number">25</span>%      <span class="number">-0.774890</span>    <span class="number">-0.591841</span>    <span class="number">-0.641675</span>    <span class="number">-0.644144</span></span><br><span class="line"><span class="number">50</span>%      <span class="number">-0.116401</span>     <span class="number">0.101143</span>     <span class="number">0.002073</span>    <span class="number">-0.013611</span></span><br><span class="line"><span class="number">75</span>%       <span class="number">0.616366</span>     <span class="number">0.780282</span>     <span class="number">0.680391</span>     <span class="number">0.654328</span></span><br><span class="line">max       <span class="number">3.000000</span>     <span class="number">2.653656</span>     <span class="number">3.000000</span>     <span class="number">3.000000</span></span><br></pre></td></tr></table></figure></p>
<h2 id="八、排列和随机采样"><a href="#八、排列和随机采样" class="headerlink" title="八、排列和随机采样"></a><strong>八、排列和随机采样</strong></h2><p>　　利用 numpy.random.permutation 函数可以轻松实现对 Series 和 DataFrame 的列的排列工作（permuting，随机重排序）。通过需要排列的轴的长度调用 permutation，产生一个表示新顺序的整数数组<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">74</span>]: df = DataFrame(np.arange(<span class="number">20</span>).reshape(<span class="number">5</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">In [<span class="number">75</span>]: sampler = np.random.permutation(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">76</span>]: sampler</span><br><span class="line">Out[<span class="number">76</span>]: array([<span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">77</span>]: <span class="comment"># 然后就可以在基于 ix 的索引操作或 take 函数中使用该数组</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">78</span>]:  df</span><br><span class="line">Out[<span class="number">78</span>]: </span><br><span class="line">    <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">0</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">1</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">3</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">4</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">79</span>]: df.take(sampler)</span><br><span class="line">Out[<span class="number">79</span>]: </span><br><span class="line">    <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">1</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">0</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">3</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">4</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br></pre></td></tr></table></figure></p>
<p>　　如果不想用替换的方式选取随机子集，则可以使用 <code>permutation：</code>从 <code>permutation</code> 返回的数组中切下前 k 个元素，其中 k 为希望的子集大小。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">81</span>]: df.take(np.random.permutation(len(df))[:<span class="number">3</span>])</span><br><span class="line">Out[<span class="number">81</span>]: </span><br><span class="line">    <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">1</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">3</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">4</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br></pre></td></tr></table></figure></p>
<h2 id="九、计算指标-哑变量"><a href="#九、计算指标-哑变量" class="headerlink" title="九、计算指标/哑变量"></a><strong>九、计算指标/哑变量</strong></h2><p>　　另一种常用于统计建模或机器学习的转换方式：将分类变量（categorical variable）转换为“哑变量矩阵”（dummy matrix）或“指标矩阵”（indicator matrix）。如果 DataFrame 的某一列中含有 k 个不同的值，则可以派生出一个 k 列矩阵或 DataFrame（其值全为1和0）。pandas 有一个 get_dummies 函数可以实现该功能：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">89</span>]: df = DataFrame(&#123;<span class="string">'key'</span>:[<span class="string">'b'</span>,<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'c'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>],</span><br><span class="line">   ....:                 <span class="string">'data1'</span>:range(<span class="number">6</span>)&#125;)</span><br><span class="line"></span><br><span class="line">In [<span class="number">90</span>]: pd.get_dummies(df[<span class="string">'key'</span>])</span><br><span class="line">Out[<span class="number">90</span>]: </span><br><span class="line">   a  b  c</span><br><span class="line"><span class="number">0</span>  <span class="number">0</span>  <span class="number">1</span>  <span class="number">0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0</span>  <span class="number">1</span>  <span class="number">0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1</span>  <span class="number">0</span>  <span class="number">0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">1</span></span><br><span class="line"><span class="number">4</span>  <span class="number">1</span>  <span class="number">0</span>  <span class="number">0</span></span><br><span class="line"><span class="number">5</span>  <span class="number">0</span>  <span class="number">1</span>  <span class="number">0</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">91</span>]: df</span><br><span class="line">Out[<span class="number">91</span>]: </span><br><span class="line">   data1 key</span><br><span class="line"><span class="number">0</span>      <span class="number">0</span>   b</span><br><span class="line"><span class="number">1</span>      <span class="number">1</span>   b</span><br><span class="line"><span class="number">2</span>      <span class="number">2</span>   a</span><br><span class="line"><span class="number">3</span>      <span class="number">3</span>   c</span><br><span class="line"><span class="number">4</span>      <span class="number">4</span>   a</span><br><span class="line"><span class="number">5</span>      <span class="number">5</span>   b</span><br><span class="line"></span><br><span class="line">In [<span class="number">92</span>]: <span class="comment"># 我们可能想给指标 DataFrame 的列加上一个前缀，以便合并</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">93</span>]: dummies = pd.get_dummies(df[<span class="string">'key'</span>],prefix = <span class="string">'key'</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">94</span>]: df_with_dummy = df[[<span class="string">'data1'</span>]].join(dummies)</span><br><span class="line"></span><br><span class="line">In [<span class="number">95</span>]: df_with_dummy</span><br><span class="line">Out[<span class="number">95</span>]: </span><br><span class="line">   data1  key_a  key_b  key_c</span><br><span class="line"><span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>      <span class="number">1</span>      <span class="number">0</span></span><br><span class="line"><span class="number">1</span>      <span class="number">1</span>      <span class="number">0</span>      <span class="number">1</span>      <span class="number">0</span></span><br><span class="line"><span class="number">2</span>      <span class="number">2</span>      <span class="number">1</span>      <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">3</span>      <span class="number">3</span>      <span class="number">0</span>      <span class="number">0</span>      <span class="number">1</span></span><br><span class="line"><span class="number">4</span>      <span class="number">4</span>      <span class="number">1</span>      <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">5</span>      <span class="number">5</span>      <span class="number">0</span>      <span class="number">1</span>      <span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<p>　　如果 DataFrame 中的某行同属于多个分类，则事情就会有点复杂。同样的同学们，木木这里给大家一个数据文件，同学们把他们粘贴到文本文件中，等会会用到<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">1::Toy Story (1995)::Animation|Children's|Comedy</span><br><span class="line">2::Jumanji (1995)::Adventure|Children's|Fantasy</span><br><span class="line">3::Grumpier Old Men (1995)::Comedy|Romance</span><br><span class="line">4::Waiting to Exhale (1995)::Comedy|Drama</span><br><span class="line">5::Father of the Bride Part II (1995)::Comedy</span><br><span class="line">6::Heat (1995)::Action|Crime|Thriller</span><br><span class="line">7::Sabrina (1995)::Comedy|Romance</span><br><span class="line">8::Tom and Huck (1995)::Adventure|Children's</span><br><span class="line">9::Sudden Death (1995)::Action</span><br><span class="line">10::GoldenEye (1995)::Action|Adventure|Thriller</span><br><span class="line">11::American President, The (1995)::Comedy|Drama|Romance</span><br><span class="line">12::Dracula: Dead and Loving It (1995)::Comedy|Horror</span><br><span class="line">13::Balto (1995)::Animation|Children's</span><br><span class="line">14::Nixon (1995)::Drama</span><br><span class="line">15::Cutthroat Island (1995)::Action|Adventure|Romance</span><br><span class="line">16::Casino (1995)::Drama|Thriller</span><br><span class="line">17::Sense and Sensibility (1995)::Drama|Romance</span><br><span class="line">18::Four Rooms (1995)::Thriller</span><br><span class="line">19::Ace Ventura: When Nature Calls (1995)::Comedy</span><br><span class="line">20::Money Train (1995)::Action</span><br><span class="line">21::Get Shorty (1995)::Action|Comedy|Drama</span><br><span class="line">22::Copycat (1995)::Crime|Drama|Thriller</span><br><span class="line">23::Assassins (1995)::Thriller</span><br><span class="line">24::Powder (1995)::Drama|Sci-Fi</span><br><span class="line">25::Leaving Las Vegas (1995)::Drama|Romance</span><br><span class="line">26::Othello (1995)::Drama</span><br><span class="line">27::Now and Then (1995)::Drama</span><br><span class="line">28::Persuasion (1995)::Romance</span><br><span class="line">29::City of Lost Children, The (1995)::Adventure|Sci-Fi</span><br><span class="line">30::Shanghai Triad (Yao a yao yao dao waipo qiao) (1995)::Drama</span><br></pre></td></tr></table></figure></p>
<p>示例如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">In [103]: mnames = ['movie_id','title','genres']</span><br><span class="line"></span><br><span class="line">In [104]: movies = pd.read_table('movies.dat', sep='::',header=None,</span><br><span class="line">   .....:                        names = mnames)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In [105]: movies[:10]</span><br><span class="line">Out[105]: </span><br><span class="line">   movie_id                               title                        genres</span><br><span class="line">0         1                    Toy Story (1995)   Animation|Children's|Comedy</span><br><span class="line">1         2                      Jumanji (1995)  Adventure|Children's|Fantasy</span><br><span class="line">2         3             Grumpier Old Men (1995)                Comedy|Romance</span><br><span class="line">3         4            Waiting to Exhale (1995)                  Comedy|Drama</span><br><span class="line">4         5  Father of the Bride Part II (1995)                        Comedy</span><br><span class="line">5         6                         Heat (1995)         Action|Crime|Thriller</span><br><span class="line">6         7                      Sabrina (1995)                Comedy|Romance</span><br><span class="line">7         8                 Tom and Huck (1995)          Adventure|Children's</span><br><span class="line">8         9                 Sudden Death (1995)                        Action</span><br><span class="line">9        10                    GoldenEye (1995)     Action|Adventure|Thriller</span><br></pre></td></tr></table></figure></p>
<p>　　要为每一个 genre 添加指标变量就需要做一些数据规整操作。首先，我们从数据集中抽取出不同的 genre 值（注意巧用 <code>set.union</code>）：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">In [106]: genre_iter = (set(x.split('|')) for x in movies.genres)</span><br><span class="line"></span><br><span class="line">In [107]: genres = sorted(set.union(*genre_iter))</span><br><span class="line"></span><br><span class="line">In [108]: # 现在我们从一个全零 DataFrame 开始构建指标 DataFrame</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In [109]: dummies = DataFrame(np.zeros((len(movies),len(genres))),</span><br><span class="line">   .....:                               columns = genres)</span><br><span class="line"></span><br><span class="line">In [110]: # 接下来，迭代每一部电影并将 dummies 各行的项设置为1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In [111]: for i,gen in enumerate(movies.genres):</span><br><span class="line">   .....:     dummies.ix[i, gen.split('|')]=1</span><br><span class="line">   .....:     </span><br><span class="line"></span><br><span class="line">In [112]: # 在将其与 movie是合并起来</span><br><span class="line"></span><br><span class="line">In [113]:  movies_windic = movies.join(dummies.add_prefix('Genre_'))</span><br><span class="line"></span><br><span class="line">In [114]: movies_windic.ix[0]</span><br><span class="line">Out[114]: </span><br><span class="line">movie_id                                      1</span><br><span class="line">title                          Toy Story (1995)</span><br><span class="line">genres              Animation|Children's|Comedy</span><br><span class="line">Genre_Action                                  0</span><br><span class="line">Genre_Adventure                               0</span><br><span class="line">Genre_Animation                               1</span><br><span class="line">Genre_Children's                              1</span><br><span class="line">Genre_Comedy                                  1</span><br><span class="line">Genre_Crime                                   0</span><br><span class="line">Genre_Drama                                   0</span><br><span class="line">Genre_Fantasy                                 0</span><br><span class="line">Genre_Horror                                  0</span><br><span class="line">Genre_Romance                                 0</span><br><span class="line">Genre_Sci-Fi                                  0</span><br><span class="line">Genre_Thriller                                0</span><br><span class="line">Name: 0, dtype: object</span><br></pre></td></tr></table></figure></p>
<p>　　一个对统计应用有用的秘诀是：结合 <code>get_dummies</code> 和诸如 <code>cut</code> 之类的离散化函数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">127</span>]: values = np.random.rand(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">128</span>]: values</span><br><span class="line">Out[<span class="number">128</span>]: </span><br><span class="line">array([ <span class="number">0.65158907</span>,  <span class="number">0.61562033</span>,  <span class="number">0.53089883</span>,  <span class="number">0.13941997</span>,  <span class="number">0.48344916</span>,</span><br><span class="line">        <span class="number">0.11734259</span>,  <span class="number">0.07557764</span>,  <span class="number">0.21863608</span>,  <span class="number">0.90953758</span>,  <span class="number">0.38441329</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">129</span>]: bins = [<span class="number">0</span>,<span class="number">0.2</span>,<span class="number">0.4</span>,<span class="number">0.6</span>,<span class="number">0.8</span>,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">130</span>]: pd.get_dummies(pd.cut(values,bins))</span><br><span class="line">Out[<span class="number">130</span>]: </span><br><span class="line">   (<span class="number">0</span>, <span class="number">0.2</span>]  (<span class="number">0.2</span>, <span class="number">0.4</span>]  (<span class="number">0.4</span>, <span class="number">0.6</span>]  (<span class="number">0.6</span>, <span class="number">0.8</span>]  (<span class="number">0.8</span>, <span class="number">1</span>]</span><br><span class="line"><span class="number">0</span>         <span class="number">0</span>           <span class="number">0</span>           <span class="number">0</span>           <span class="number">1</span>         <span class="number">0</span></span><br><span class="line"><span class="number">1</span>         <span class="number">0</span>           <span class="number">0</span>           <span class="number">0</span>           <span class="number">1</span>         <span class="number">0</span></span><br><span class="line"><span class="number">2</span>         <span class="number">0</span>           <span class="number">0</span>           <span class="number">1</span>           <span class="number">0</span>         <span class="number">0</span></span><br><span class="line"><span class="number">3</span>         <span class="number">1</span>           <span class="number">0</span>           <span class="number">0</span>           <span class="number">0</span>         <span class="number">0</span></span><br><span class="line"><span class="number">4</span>         <span class="number">0</span>           <span class="number">0</span>           <span class="number">1</span>           <span class="number">0</span>         <span class="number">0</span></span><br><span class="line"><span class="number">5</span>         <span class="number">1</span>           <span class="number">0</span>           <span class="number">0</span>           <span class="number">0</span>         <span class="number">0</span></span><br><span class="line"><span class="number">6</span>         <span class="number">1</span>           <span class="number">0</span>           <span class="number">0</span>           <span class="number">0</span>         <span class="number">0</span></span><br><span class="line"><span class="number">7</span>         <span class="number">0</span>           <span class="number">1</span>           <span class="number">0</span>           <span class="number">0</span>         <span class="number">0</span></span><br><span class="line"><span class="number">8</span>         <span class="number">0</span>           <span class="number">0</span>           <span class="number">0</span>           <span class="number">0</span>         <span class="number">1</span></span><br><span class="line"><span class="number">9</span>         <span class="number">0</span>           <span class="number">1</span>           <span class="number">0</span>           <span class="number">0</span>         <span class="number">0</span></span><br></pre></td></tr></table></figure></p>

        </div>
        <footer class="article-footer">
            
    <div class="jiathis_style">
    <span class="jiathis_txt">分享到：</span>
    <a class="jiathis_button_qzone">QQ空间</a>
    <a class="jiathis_button_tsina">新浪微博</a>
    <a class="jiathis_button_tqq">腾讯微博</a>
    <a class="jiathis_button_weixin">微信</a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
    <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<style>
    .jiathis_style div:first-child:not(.jiadiv_01) {
        width: auto !important;
        border: none !important;
    }
    .jiathis_style .jiadiv_01 {
        margin: 10px 0;
        border-radius: 4px;
        border: #e1e1e1 solid 1px;
    }
    .jiathis_style .jiadiv_01 div:first-child {
        display: none;
    }
    .jiathis_style .jiadiv_02 {
        padding: 7px 0 !important;
    }
    .jiathis_style .jiadiv_02 .jiatitle {
        width: 85px;
        border: none;
        height: auto;
        margin: 3px 10px;
        padding: 6px 10px;
        border-radius: 4px;
    }
    .jiathis_style .jiadiv_02 .jiatitle:hover {
        border: none;
    }
    .jiathis_style .jiadiv_02 .jiatitle:nth-child(even) {
        margin-left: 0;
    }
    .jiathis_style .jtico:hover {
        opacity: 1;
    }
    .jiathis_style .ckepopBottom,
    .jiathis_style .centerBottom {
        width: auto !important;
        padding: 5px;
        background: #f7f7f7;
    }
</style>




        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div class="ds-thread" data-thread-key="2016/05/24/PANDAS常用手册-VI-数据转换/" data-title="PANDAS常用手册 VI --数据转换" data-url="http://yoursite.com/2016/05/24/PANDAS常用手册-VI-数据转换/"></div>
    <style>
        #ds-thread #ds-reset .ds-textarea-wrapper {
            background: none;
        }
        #ds-reset .ds-avatar img {
            box-shadow: none;
        }
        #ds-reset .ds-gradient-bg {
            background: #f7f7f7;
        }
        #ds-thread #ds-reset li.ds-tab a {
            border-radius: 3px;
        }
        #ds-thread #ds-reset .ds-post-button {
            color: white;
            border: none;
            box-shadow: none;
            background: #d32;
            text-shadow: none;
            font-weight: normal;
            font-family: 'Microsoft Yahei';
        }
        #ds-thread #ds-reset .ds-post-button:hover {
            color: white;
            background: #DE594C;
        }
        #ds-thread #ds-reset .ds-post-button:active {
            background: #d32;
        }
        #ds-smilies-tooltip ul.ds-smilies-tabs li a.ds-current {
            color: white;
            background: #d32;
            box-shadow: none;
            text-shadow: none;
            font-weight: normal;
        }
    </style>

    
    </section>

                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>follow:</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/FanShipKwan/" target="_blank">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="weibo" href="http://weibo.com/u/1846194245" target="_blank">
                        <i class="icon fa fa-weibo"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="rss" href="/" target="_blank">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2016/05/24/PANDAS常用手册-VII-字符串操作/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">newer</strong>
        <p class="article-nav-title">
        
            PANDAS常用手册 VII -- 字符串操作
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/2016/05/24/PANDAS常用手册-V-重塑和轴向旋转/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">older</strong>
        <p class="article-nav-title">PANDAS常用手册 V -- 重塑和轴向旋转</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                
    <div class="widget-wrap">
        <h3 class="widget-title">recents</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2016/05/24/PANDAS常用手册-XII-透视表和交叉表/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2016/05/24/PANDAS常用手册-XII-透视表和交叉表/" class="title">PANDAS常用手册 XII -透视表和交叉表</a></p>
                            <p class="item-date"><time datetime="2016-05-24T13:24:48.818Z" itemprop="datePublished">2016-05-24</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2016/05/24/PANDAS常用手册-XI-分组级运算和转换/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2016/05/24/PANDAS常用手册-XI-分组级运算和转换/" class="title">PANDAS常用手册 XI -- 分组级运算和转换</a></p>
                            <p class="item-date"><time datetime="2016-05-24T13:24:42.795Z" itemprop="datePublished">2016-05-24</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2016/05/24/PANDAS常用手册-X-数据聚合/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2016/05/24/PANDAS常用手册-X-数据聚合/" class="title">PANDAS常用手册 X -- 数据聚合</a></p>
                            <p class="item-date"><time datetime="2016-05-24T13:24:30.406Z" itemprop="datePublished">2016-05-24</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2016/05/24/PPANDAS常用手册-IX-groupby-技术/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2016/05/24/PPANDAS常用手册-IX-groupby-技术/" class="title">PPANDAS常用手册 IX -- groupby 技术</a></p>
                            <p class="item-date"><time datetime="2016-05-24T13:24:23.174Z" itemprop="datePublished">2016-05-24</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2016/05/24/PANDAS常用手册-VIII-绘图和可视化/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2016/05/24/PANDAS常用手册-VIII-绘图和可视化/" class="title">PANDAS常用手册 VIII -- 绘图和可视化</a></p>
                            <p class="item-date"><time datetime="2016-05-24T13:24:17.058Z" itemprop="datePublished">2016-05-24</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">tags</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/PYTHON科学计算/">PYTHON科学计算</a><span class="tag-list-count">12</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/PYTHON科学计算/" style="font-size: 10px;">PYTHON科学计算</a>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>
                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2016 善能菌</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p>
            </div>
        </div>
    </div>
</footer>
        
    
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'freefarm# enter duoshuo shortname here'};
    (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
    || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>



    
        <script src="/vendor/fancybox/jquery.fancybox.pack.js"></script>
    

    
        <script src="/vendor/scrollLoading/jquery.scrollLoading.js"></script>
        <script src="/vendor/scrollLoading/main.js"></script>
    


<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>
